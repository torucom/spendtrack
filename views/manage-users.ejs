<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç† - SpendTrack</title>
    <link rel="stylesheet" href="/css/style.css">
    <script>
        async function deleteUser(userId) {
            if (!confirm("æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) return;

            const response = await fetch("/manage-users/delete", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ id: userId }) // ğŸ”¹ idã‚­ãƒ¼ã«çµ±ä¸€
            });

            if (response.ok) {
                alert("å‰Šé™¤ã—ã¾ã—ãŸ");
                location.reload();
            } else {
                alert("å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ");
            }
        }
    </script>
</head>
<body>
<header>
    <h1>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</h1>
    <a href="/">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>
</header>

<section>
    <h2>ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼</h2>
    <table class="user-table">
        <thead>
        <tr>
            <th>ID</th>
            <th>åå‰</th>
            <th>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</th>
            <th>æ¨©é™</th>
            <th>æ“ä½œ</th>
        </tr>
        </thead>
        <tbody>
        <% users.forEach(user => { %>
            <tr>
                <td><%= user.id %></td>
                <td><%= user.name %></td>
                <td><%= user.email %></td>
                <td><%= user.role %></td>
                <td>
                    <% if (user.id !== "admin") { %>
                        <!-- å‰Šé™¤ãƒ•ã‚©ãƒ¼ãƒ  -->
                        <form action="/manage-users/delete" method="POST" onsubmit="return confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');">
                            <input type="hidden" name="id" value="<%= user.id %>">
                            <button type="submit">å‰Šé™¤</button>
                        </form>
                    <% } else { %>
                        (ç®¡ç†è€…)
                    <% } %>
                </td>
            </tr>
        <% }) %>
        </tbody>
    </table>

    <h2>æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼è¿½åŠ </h2>
    <form action="/manage-users/add" method="POST">
        <label>ID: <input type="text" name="id" required></label><br>
        <label>ãƒ¡ãƒ¼ãƒ«: <input type="email" name="email" required></label><br>
        <label>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: <input type="password" name="password" required></label><br>
        <label>åå‰: <input type="text" name="name" required></label><br>
        <label>ãƒ­ãƒ¼ãƒ«:
            <select name="role">
                <option value="user">ãƒ¦ãƒ¼ã‚¶ãƒ¼</option>
                <option value="admin">ç®¡ç†è€…</option>
            </select>
        </label><br>
        <button type="submit">è¿½åŠ </button>
    </form>
</section>
</body>
</html>